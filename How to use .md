# じゃんけん画像分類AIプロジェクト - 使い方ガイド

## 🎯 プロジェクト概要

このプロジェクトは、**シンギュライティバトルクエスト**という大会用のじゃんけん画像分類AIを作成するためのものです。
与えられた手の画像（グー、チョキ、パー）を自動で判別するAIを作り、その精度を競い合います。

### 目標
- 手の画像からじゃんけんの手（グー・チョキ・パー）を正確に分類する
- 高い精度を達成して大会で良い成績を収める
- Python初心者でも理解できるコードで実装する

## 📁 プロジェクト構成

```
aq_2025/
├── janken_train.py         # AIの学習を行うメインファイル
├── janken_predict.py       # 学習したAIで予測を行うファイル
├── requirements.txt        # 必要なライブラリ一覧
├── .gitignore             # Git管理対象外ファイルの設定
├── How to use .md         # このファイル（使い方ガイド）
├── models/                # 学習済みモデル保存フォルダ
├── img_train/             # 学習用画像フォルダ
│   ├── 0_gu/             # グーの画像
│   ├── 1_tyoki/          # チョキの画像
│   └── 2_pa/             # パーの画像
├── img_test/              # テスト用画像フォルダ
│   ├── 0_gu/             # グーの画像（テスト用）
│   ├── 1_tyoki/          # チョキの画像（テスト用）
│   └── 2_pa/             # パーの画像（テスト用）
└── dataset/               # 大会提供のデータセット
```

## 🚀 初期セットアップ（最初に一度だけ）

### 1. 必要な環境の確認

**必要なもの:**
- Python 3.9以上
- MacBook（このプロジェクトはMacで動作することを前提）
- 十分な空き容量（最低5GB以上推奨）
- インターネット接続（ライブラリのダウンロード用）

### 2. Pythonのバージョン確認

ターミナルを開いて以下のコマンドを実行：
```bash
python3 --version
```
`Python 3.9.0`以上が表示されればOKです。

### 3. プロジェクトフォルダに移動

```bash
cd /Users/hiro/Documents/aq_2025
```

### 4. 必要なライブラリのインストール

```bash
pip3 install -r requirements.txt
```

**注意：** エラーが出た場合は以下を試してください：
```bash
python3 -m pip install --upgrade pip
pip3 install -r requirements.txt
```

### 5. フォルダ構造の作成

必要なフォルダが存在しない場合は作成：
```bash
mkdir -p models img_train/0_gu img_train/1_tyoki img_train/2_pa
mkdir -p img_test/0_gu img_test/1_tyoki img_test/2_pa
mkdir -p dataset
```

## 📸 画像データの準備

### 画像の配置方法

#### 学習用画像（`img_train/`フォルダ）
- `img_train/0_gu/`：グーの画像を配置
- `img_train/1_tyoki/`：チョキの画像を配置  
- `img_train/2_pa/`：パーの画像を配置

#### テスト用画像（`img_test/`フォルダ）
- `img_test/0_gu/`：グーの画像を配置（学習に使わないもの）
- `img_test/1_tyoki/`：チョキの画像を配置（学習に使わないもの）
- `img_test/2_pa/`：パーの画像を配置（学習に使わないもの）

### 画像の形式
- **対応形式：** JPG、PNG、JPEG
- **推奨サイズ：** 224×224ピクセル（自動でリサイズされます）
- **推奨枚数：** 各クラス最低100枚以上

### 画像収集のコツ
1. **多様性を重視：** 色々な角度、明るさ、背景で撮影
2. **手の向き：** 左手・右手両方を含める
3. **背景：** 様々な背景で撮影（無地、パターン、屋外など）
4. **照明条件：** 明るい場所、暗い場所、自然光、人工光など

## 🤖 AIの学習方法

### 1. 学習の実行

画像データを準備したら、以下のコマンドでAIの学習を開始：

```bash
python3 janken_train.py
```

### 2. 学習中に表示される情報

```
Epoch 1/50
Found 300 images belonging to 3 classes.
Found 90 images belonging to 3 classes.
Train Accuracy: 0.6500
Validation Accuracy: 0.7222
```

- **Epoch：** 学習の進行度（1/50は50回中1回目）
- **Train Accuracy：** 学習データでの正答率
- **Validation Accuracy：** 検証データでの正答率

### 3. 学習完了時

学習が完了すると以下のファイルが作成されます：
- `models/janken_model.h5`：学習済みモデル
- `models/training_history.png`：学習過程のグラフ

### 4. 学習時間の目安

- **CPU使用時：** 約30分〜2時間
- **GPU使用時：** 約5分〜30分（M1/M2 Macの場合）

## 🔮 予測の実行方法

### 1. 単一画像の予測

```bash
python3 janken_predict.py --image path/to/your/image.jpg
```

**例：**
```bash
python3 janken_predict.py --image img_test/0_gu/test_gu_001.jpg
```

### 2. フォルダ内全画像の予測

```bash
python3 janken_predict.py --folder img_test/
```

### 3. 予測結果の見方

```
画像: test_gu_001.jpg
予測結果: グー (確信度: 95.3%)
実際のラベル: グー
判定: 正解 ✓

画像: test_tyoki_001.jpg  
予測結果: チョキ (確信度: 87.1%)
実際のラベル: チョキ
判定: 正解 ✓
```

## 📊 モデルの性能評価

### 1. 精度の確認

学習完了後、以下のような結果が表示されます：

```
=== 最終結果 ===
学習データ精度: 96.5%
検証データ精度: 92.3%
テストデータ精度: 90.1%

=== クラス別精度 ===
グー: 93.2%
チョキ: 89.5%  
パー: 88.9%
```

### 2. 良い性能の目安

- **全体精度：** 85%以上
- **各クラス精度：** 80%以上
- **学習・検証精度の差：** 5%以内（過学習の回避）

## 🛠 トラブルシューティング

### よくあるエラーと解決方法

#### 1. `ModuleNotFoundError: No module named 'tensorflow'`

**原因：** TensorFlowがインストールされていない
**解決方法：**
```bash
pip3 install tensorflow
```

#### 2. `FileNotFoundError: No such file or directory`

**原因：** 画像フォルダが存在しない、または画像が入っていない
**解決方法：**
- フォルダの存在確認
- 画像ファイルの配置確認

#### 3. 学習が進まない・精度が上がらない

**原因と解決方法：**
- **データ不足：** 各クラス100枚以上の画像を用意
- **データの質：** ぼやけた画像や不適切な画像を除去
- **データの多様性：** 様々な条件で撮影した画像を追加

#### 4. メモリエラー

**原因：** メモリ不足
**解決方法：**
- 他のアプリケーションを閉じる
- バッチサイズを小さくする（コード内で調整）

### パフォーマンス向上のコツ

#### 1. データの改善
- **Data Augmentation：** 既存画像の回転・反転・明度調整
- **前処理：** 画像の正規化・リサイズの最適化
- **バランス：** 各クラスの画像数を揃える

#### 2. モデルの改善
- **転移学習：** 事前学習済みモデルの活用
- **ハイパーパラメータ調整：** 学習率・バッチサイズの最適化
- **早期停止：** 過学習の防止

## 📈 学習過程の理解

### 1. エポック（Epoch）とは
- データセット全体を1回学習することを「1エポック」と呼ぶ
- 通常20〜100エポック程度学習する
- エポック数が多すぎると過学習のリスク

### 2. 損失（Loss）とは
- AIの予測と正解の差を数値化したもの
- 小さいほど良い（理想は0に近い値）
- 学習が進むにつれて減少するのが正常

### 3. 精度（Accuracy）とは
- 正解した予測の割合（0〜1または0%〜100%）
- 高いほど良い性能
- 学習が進むにつれて上昇するのが正常

## 🎯 大会に向けた準備

### 1. 最終チェック項目

- [ ] 学習データの質と量は十分か
- [ ] 過学習していないか（学習・検証精度の差が小さいか）
- [ ] テストデータで85%以上の精度が出ているか
- [ ] 予測速度は十分速いか

### 2. 提出前の確認

- [ ] `janken_predict.py`が正常に動作するか
- [ ] 必要なファイルが全て揃っているか
- [ ] コードにエラーが無いか

### 3. 禁止事項の再確認

❌ **やってはいけないこと：**
- 外部API（ChatGPT等の生成AI含む）の使用
- 特定データのみを対象とした加工
- 事前に作成した予測結果の埋め込み

✅ **やって良いこと：**
- 転移学習の使用
- Data Augmentationの適用
- 与えられたデータの加工・分割

## 🆘 困ったときの対処法

### 1. エラーが解決しない場合

1. エラーメッセージを正確に読む
2. Google検索で解決方法を調べる
3. Python・TensorFlowの公式ドキュメントを確認
4. 同じエラーで困っている人の解決事例を参考にする

### 2. 性能が上がらない場合

1. データの質を見直す
2. 画像の前処理を改善する
3. モデルの構造を変更する
4. ハイパーパラメータを調整する

### 3. コードが理解できない場合

1. コメントを丁寧に読む
2. 分からない関数をGoogleで調べる
3. 小さな部分から動かして理解する
4. TensorFlow/Kerasのチュートリアルを参考にする

## 📚 参考資料

### 学習に役立つサイト
- [TensorFlow公式チュートリアル](https://www.tensorflow.org/tutorials)
- [Keras公式ドキュメント](https://keras.io/)
- [機械学習入門（日本語）](https://www.tensorflow.org/tutorials/keras/classification?hl=ja)

### 画像分類の基礎知識
- CNN（畳み込みニューラルネットワーク）
- Data Augmentation（データ拡張）
- Transfer Learning（転移学習）
- Cross Validation（交差検証）

---

**Good Luck! 🎉**

このガイドを参考に、素晴らしいじゃんけんAIを作成してください！
分からないことがあれば、一つずつ丁寧に調べながら進めることが大切です。